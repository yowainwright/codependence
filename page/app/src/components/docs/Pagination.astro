---
import SIDEBAR from "../../constants/sidebar";
import { ChevronLeftIcon, ChevronRightIcon } from "../common/Icons";

let currentPath = Astro.url.pathname;
let prevItem, nextItem;
let currentSectionIndex: number, currentItemIndex: number;

SIDEBAR.forEach((item, index) => {
  if (
    item.items &&
    item.items.some((subItem) => subItem.href === currentPath)
  ) {
    currentSectionIndex = index;
    currentItemIndex = item.items.findIndex(
      (subItem) => subItem.href === currentPath
    );
    return;
  }
});

if (currentSectionIndex !== undefined) {
  if (currentItemIndex > 0) {
    prevItem = SIDEBAR[currentSectionIndex].items[currentItemIndex - 1];
  } else if (currentSectionIndex > 0) {
    prevItem = SIDEBAR[currentSectionIndex - 1].items.slice(-1)[0];
  } else {
    prevItem = undefined;
  }

  if (currentItemIndex < SIDEBAR[currentSectionIndex].items.length - 1) {
    nextItem = SIDEBAR[currentSectionIndex].items[currentItemIndex + 1];
  } else if (currentSectionIndex < SIDEBAR.length - 1) {
    nextItem = SIDEBAR[currentSectionIndex + 1].items[0];
  } else {
    nextItem = undefined;
  }
} else {
  prevItem = nextItem = undefined;
}
---

<div class="flex gap-7">
  {
    prevItem?.href && (
      <a class="mr-auto flex" href={prevItem?.href}>
        <button class="btn btn-ghost rounded-full border-none hover:bg-base-200">
          <ChevronLeftIcon client:load className="w-5 h-5" />
          <span class="text-xs md:text-sm font-medium">{prevItem?.title}</span>
        </button>
      </a>
    )
  }

  {
    nextItem?.href && (
      <a class="ml-auto flex" href={nextItem?.href}>
        <button class="btn btn-ghost rounded-full border-none hover:bg-base-200">
          <span class="text-xs md:text-sm font-medium">{nextItem?.title}</span>
          <ChevronRightIcon client:load className="w-5 h-5" />
        </button>
      </a>
    )
  }
</div>
